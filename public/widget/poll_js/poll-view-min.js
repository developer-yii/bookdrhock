jQuery(document).ready((function(){function e(){$(".lazyload").length>0&&$(".lazyload").lazyload({event:"lazyload",effect:"fadeIn",effectspeed:2e3}).trigger("lazyload")}function t(){if($(".fandomz-poll-widget .imagelight-box").length>0){var e=0;$(".fandomz-poll-widget .imagelight-box a").each((function(){e++,$(this).attr("data-fancybox","optionimage-"+e),$(this).attr("data-caption",$(this).find("img").attr("alt")),$(this).attr("title",$(this).find("img").attr("alt"))})),$(".imagelight-box a").fancybox()}}function o(){if($("#clockdiv").length>0&&(null!=$("#clockdiv").attr("data-startdatetime")||null!=$("#clockdiv").attr("data-enddatetime"))){var e=$("#clockdiv").attr("data-startdatetime").replace(" ","T").split(/[^0-9]/),t=new Date(Date.UTC(e[0],e[1]-1,e[2],e[3],e[4],e[5])),o=$("#clockdiv").attr("data-enddatetime").replace(" ","T").split(/[^0-9]/),n=new Date(Date.UTC(o[0],o[1]-1,o[2],o[3],o[4],o[5]));deadlineString=headinText="";new Date>n?(new Date(t).getTime(),deadlineString=t,headinText="Poll ended",$(".poll-options-main").empty().append('')):new Date>t?(new Date(n).getTime(),deadlineString=n,headinText="time left"):(new Date(t).getTime(),deadlineString=t,headinText="comming soon",$(".poll-options-main").empty().append('')),$(".countdown-heading").text(headinText);var l=deadlineString,a=(new Date,setInterval((function(){if($("#day").length>0){var e=new Date,t=l-e,o=Math.floor(t/864e5),n=Math.floor(t%864e5/36e5),i=Math.floor(t%36e5/6e4),r=Math.floor(t%6e4/1e3);document.getElementById("day").innerHTML=1==o.toString().length?"0"+o:o,document.getElementById("hour").innerHTML=1==n.toString().length?"0"+n:n,document.getElementById("minute").innerHTML=1==i.toString().length?"0"+i:i,document.getElementById("second").innerHTML=1==r.toString().length?"0"+r:r,t<0&&(clearInterval(a),document.getElementById("day").innerHTML="00",document.getElementById("hour").innerHTML="00",document.getElementById("minute").innerHTML="00",document.getElementById("second").innerHTML="00")}}),1e3))}}$(".fandomz-poll-widget #poll-vote-form").length>0&&$(".fandomz-poll-widget #poll-vote-form")[0].reset(),$(".fandomz-poll-widget").on("click",".option-container-details .card-poll",(function(e){e.preventDefault(),maximumVoteInNumber>0&&$(".option-container-details .card-poll.selected").length==maximumVoteInNumber&&!$(this).hasClass("selected")?1==maximumVoteInNumber?($(".fandomz-poll-widget .option-container-details .card-poll").removeClass("selected"),$(this).addClass("selected")):showMessage("error","You can choose "+maximumVoteInWord+" option only"):$(this).toggleClass("selected")})),$(".fandomz-poll-widget").on("click",".option-container-details .imagelight-box a",(function(e){e.preventDefault(),$(this).parents(".card-poll").toggleClass("selected")})),setTimeout((function(){t(),o(),e()}),1e3);let n=".fandomz-poll-widget #poll-vote-form",l=".error-span",a="#fandomz_submit_voting";$(".fandomz-poll-widget").on("keypress","input",(function(e){return 13!=e.keyCode||($(".fandomz-poll-widget #fandomz_submit_voting").click(),!1)})),$(".fandomz-poll-widget").on("click",a,(function(e){if(e.preventDefault(),$(".fandomz-poll-widget .option-container-details .card-poll.selected").length>0){let e=new FormData($(n)[0]),i=[];if($(".fandomz-poll-widget .option-container-details .card-poll.selected").each((function(){i.push($(this).find("input.option_id").val())})),e.append("selected_options",i),$(l).addClass("d-none").text(""),$(n).find("input").parents(".form-group").removeClass("has-error"),function(){var e=$(".fandomz-poll-widget  #vote_schedule").val(),t=$(".fandomz-poll-widget #vote_add").val();e=void 0!==e&&e?parseInt(e):24,t=void 0!==t&&t?parseInt(t):1;var o=moment().subtract({hours:Math.abs(e)}),n=(moment(),new Array),l=c(d),a=0;if(void 0!==l&&l&&l.length){var i=l.split(",");$.each(i,(function(e,t){moment(t)>=o&&(n.push(t),a++)}))}return console.log(a),a<t}())$.ajax({url:routes.votingUrl,method:"POST",data:e,contentType:!1,processData:!1,beforeSend:function(){$(a).addClass("lodder"),$(a).attr("disabled",!0)},success:function(e){$("#poll-vote-form")[0].reset(),"success"==e.response?(!function(){var e=moment().subtract({hours:24}),t=new Array,o=c(d);if(void 0!==o&&o){var n=o.split(",");$.each(n,(function(o,n){moment(n)>=e&&t.push(n)}))}t.push(moment().format()),function(e,t){var o=new Date;o.setTime(o.getTime()+864e5);var n="; expires="+o.toGMTString();document.cookie=e+"="+t+n+"; path=/"}(d,t)}(),showMessage("success",e.message),$(".poll-heading")[0].scrollIntoView(),reinitPreloader(),s(e.slug)):"votedone"==e.response?($(n)[0].reset(),$(".fandomz-poll-widget .option-container-details .card-poll.selected").removeClass("selected"),showMessage("success",e.message),$(".poll-heading")[0].scrollIntoView(),reinitPreloader(),s(e.slug)):showMessage("error","something is wrong!")},complete:function(){$(a).removeClass("lodder"),$(a).attr("disabled",!1)},error:function(e){var t="";if(e.responseJSON.errors&&$.each(e.responseJSON.errors,(function(e,o){"g-recaptcha-response"==e&&(e="enabledgooglecaptcha"),"h-captcha-response"==e&&(e="enabledhcaptcha"),""==t&&(t=e),$(".fandomz-poll-widget #"+e).parents(".form-group").find(l).removeClass("d-none").text(o),$(".fandomz-poll-widget #"+e).parents(".form-group").addClass("has-error"),$(n).find("#"+t).focus()})),e.responseJSON.message){showMessage("error",e.responseJSON.message);var o=$(".fandomz-poll-widget #slug").val();e.responseJSON.is_reload&&o&&($(".poll-heading")[0].scrollIntoView(),reinitPreloader(),s(o))}}});else{var t=$(".fandomz-poll-widget #vote_schedule").val(),o=$(".fandomz-poll-widget #slug").val();showMessage("success","You've completed your vote, vote again in "+t+" hours"),$(".poll-heading")[0].scrollIntoView(),reinitPreloader(),s(o)}}else showMessage("error","please select any option")}));let i=".fandomz_result_list";$(".fandomz-poll-widget").on("click",i,(function(e){e.preventDefault();var t=$("#slug").val();$(".poll-heading")[0].scrollIntoView(),reinitPreloader(),s(t)}));let r=".fandomz_poll_list";function s(o){$.ajax({url:routes.resultsUrl+"/"+o,method:"GET",contentType:!1,processData:!1,beforeSend:function(){$(i).addClass("lodder"),$(i).attr("disabled",!0)},success:function(n){initPreloader(),$(i).removeClass("lodder"),$(i).attr("disabled",!1),function(o,n){$("#poll_list_"+o).hide(),$("#poll_list_"+o).html(""),$("#poll_result_"+o).show(),$("#poll_result_"+o).html(n),setTimeout((function(){t(),e()}),1e3)}(o,n.html)},error:function(e){}})}$(".fandomz-poll-widget").on("click",r,(function(n){n.preventDefault();var l=$("#slug").val();$(".poll-heading")[0].scrollIntoView(),reinitPreloader(),function(n){$.ajax({url:routes.indexUrl+"/"+n,method:"GET",contentType:!1,processData:!1,beforeSend:function(){$(r).addClass("lodder"),$(r).attr("disabled",!0)},success:function(l){initPreloader(),$(r).removeClass("lodder"),$(r).attr("disabled",!1),function(n,l){$("#poll_list_"+n).show(),$("#poll_list_"+n).html(l),$("#poll_result_"+n).hide(),$("#poll_result_"+n).html(""),setTimeout((function(){onloadCallback(),onloadCallbackH(),t(),o(),e()}),1e3)}(n,l)},error:function(e){}})}(l)}));var d=$(".fandomz-poll-widget").attr("data-slug");function c(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}d="widget_"+d}));